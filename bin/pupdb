#!/usr/bin/env ruby

$LOAD_PATH << File.expand_path("../../lib", __FILE__)

require 'hieracles'
require 'hieracles/options/pupdb'

opt = Hieracles::Options::Pupdb.new(ARGV)

if opt.options.has_key? :version
  puts Hieracles.version
  exit(0)
end

command = opt.payload[0]
args = opt.payload[2..-1]

unless command
  puts Hieracles::Options::Pupdb.usage
  exit(1)
end

Hieracles::Config.load opt.options

if Hieracles::Puppetdb::Request.method_defined? command

else
  puts "*** Unknown command: #{command}"
  puts Hieracles::Options::Pupdb.usage
  exit(1)
end
